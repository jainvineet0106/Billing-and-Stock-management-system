<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Admin Panal</title>
    <link rel="icon" href="assets/images/favicon.png">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet" />   
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.10.5/font/bootstrap-icons.css">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.3/dist/js/bootstrap.bundle.min.js"></script>
    <link rel="stylesheet" href="assets/CSS/style.css">
</head>
<body>
    <div class="sidebar" id="sidebar">
        <h4 class="text-center mb-4">ðŸ›’ Admin Panel</h4>
        <a href="#" class="" onclick="pywebchannel.open_dashboard()"><i class="bi bi-speedometer2 me-2"></i>Dashboard</a>
        <a href="#" class="" onclick="pywebchannel.open_billing()" ><i class="bi bi-wallet2 me-2"></i>Billing</a>
        <a href="#" class="active" onclick="pywebchannel.open_products()"><i class="bi bi-box-seam me-2"></i>Products</a>
        <a href="#" class="" onclick="pywebchannel.open_customers()"><i class="bi bi-people me-2"></i>Customers</a>
        <a href="#" class="" onclick="pywebchannel.open_settings()"><i class="bi bi-gear me-2"></i>Settings</a>
        <a href="#" class="nav-link text-danger mt-3" onclick="pywebchannel.logout()"><i class="bi bi-box-arrow-right me-2"></i>Logout</a>
    </div>
    <div class="content" id="content_slide">
        <nav class="navbar navbar-expand-lg navbar-light bg-light rounded shadow-sm mb-4">
        <div class="container-fluid">
            <button class="btn btn-outline-secondary" id="toggle-btn">
                <i class="bi bi-list"></i>
            </button>
        <span class="navbar-brand d-flex align-items-center gap-3">
            <h2>Welcome,<span id="usernameDisplay"></span>!</h2>
        </span>
        </div>
        </nav>
        <div class="container mt-5">
        <div class="card shadow-lg border-0">
            <div class="card-header bg-primary text-white">
            <h4 class="mb-0"><i class="fas fa-edit me-2 text-white"></i>Edit Product</h4>
            </div>
            <div class="card-body p-4">
                <form id="productdata">
                    <div class="mb-3">
                        <input value="" type="hidden" class="form-control" id="id" name="id" required>
                        <label for="productName" class="form-label fw-semibold">
                        <i class="fas fa-box me-2 text-primary"></i>Product Name<span style="color: red">*</span>
                        </label>
                        <input value="" type="text" class="form-control" id="productName" placeholder="Enter Product Name" name="product_name" required>
                    </div>
                    <div class="mb-3">
                        <label for="productPrice" class="form-label fw-semibold">
                        <i class="fas fa-tag me-2 text-primary"></i>Price (â‚¹)<span style="color: red">*</span>
                        </label>
                        <input value="" type="number" class="form-control" id="productPrice" placeholder="Enter Price" name="price" min="1" required>
                    </div>
                    <div class="mb-3">
                        <label for="productStock" class="form-label">
                        <i class="fas fa-boxes me-2 text-primary"></i>Stock <span class="text-danger">*</span>
                        </label>
                        <input value="" type="number" class="form-control" id="productStock" placeholder="Enter Stock" name="stock" min="0" required>
                    </div>
                    <div class="mb-3">
                        <label for="productStock" class="form-label">
                        <i class="fas fa-boxes me-2 text-primary"></i>New Stock <span class="text-danger">*</span>
                        </label>
                        <input value="" type="number" class="form-control" id="productnewStock" placeholder="Enter New Stock" name="newstock" min="0" required>
                    </div>
                    <div class="text-end">
                        <button type="submit" class="btn btn-success px-4">
                        <i class="fas fa-check-circle me-1"></i>Update Product
                        </button>
                    </div>
                </form>
            </div>
        </div>
        </div>
    </div>

  <footer class="bg-dark text-white text-center py-4">
    <p class="mb-0">&copy; 2025 Billing and Stock management. All rights reserved. Designed by Vineet Jain.</p>
  </footer>

  <script src="qrc:///qtwebchannel/qwebchannel.js"></script>
  <script>
      new QWebChannel(qt.webChannelTransport, function(channel) {
        window.pywebchannel = channel.objects.pywebchannel;
        document.getElementById("productdata").addEventListener("submit", function(e){
            e.preventDefault();
            let id = this.id.value;
            let name = this.product_name.value;
            let price = this.price.value;
            let stock = this.stock.value;
            let newstock = this.newstock.value;
            stock = parseInt(stock) + parseInt(newstock);
            pywebchannel.updateproducts(id, name, price, stock);
        });
      });
  </script>

  <script>
    const urlParams = new URLSearchParams(window.location.search);
    const username = urlParams.get('username');
    const id = urlParams.get('id');
    const product_id = urlParams.get('product_id');
    const name = urlParams.get('name');
    const price = urlParams.get('price');
    const stock = urlParams.get('stock');
    document.getElementById('usernameDisplay').innerText = username;
    let form = document.getElementsByClassName("form-control");
    Array.from(form).forEach(element => {
        if (element.name === "id") {
            element.value = id || "";
        }else if (element.name === "product_name"){
            element.value = name || "";
        }else if (element.name === "price") {
            element.value = price || "";
        }else if (element.name === "stock") {
            element.value = stock || "";
        }
    });
  </script>
</body>
</html>